<!DOCTYPE html>
<html>

<head>
    <title>Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        html,
        body {
            height: 100%;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-dark bg-dark px-3 sticky-top">
        <span class="navbar-brand">Spam Detection System</span>
        <div>
            <a href="/" class="btn btn-outline-light btn-sm">Home</a>
            <a href="/inbox" class="btn btn-outline-light btn-sm">Inbox</a>
            <a href="/history" class="btn btn-outline-light btn-sm">History</a>
            <a href="/dashboard" class="btn btn-outline-light btn-sm">Dashboard</a>
            <a href="/logout" class="btn btn-danger btn-sm">Logout</a>
        </div>
    </nav>

    <div class="main-content">
        <div class="container mt-4">

            <!-- SUMMARY CARDS -->
            <div class="row text-center mb-4">
                <div class="col-md-4">
                    <div class="card shadow p-3">
                        <h5>Total Messages</h5>
                        <h3>{{ total_count }}</h3>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card shadow p-3 bg-danger text-white">
                        <h5>Spam</h5>
                        <h3>{{ spam_count }}</h3>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card shadow p-3 bg-success text-white">
                        <h5>Not Spam</h5>
                        <h3>{{ ham_count }}</h3>
                    </div>
                </div>
            </div>

            <!-- CHART -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card shadow p-3">
                        <h5 class="text-center">Spam vs Not Spam</h5>
                        <div style="width:300px; margin:auto;">
                            <canvas id="spamChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- MODEL INFO -->
                <div class="col-md-6">
                    <div class="card shadow p-3">
                        <h5>Model Information</h5>
                        <ul>
                            <li>Algorithm: Naive Bayes</li>
                            <li>Vectorizer: TF-IDF</li>
                            <li>Total Predictions: {{ total_count }}</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- RECENT MESSAGES -->
            <div class="card shadow p-3">
                <h5>Recent Messages</h5>
                <table class="table table-bordered table-striped">
                    <tr>
                        <th>Message</th>
                        <th>Prediction</th>
                        <th>Date</th>
                    </tr>
                    {% for row in recent_records %}
                    <tr>
                        <td>{{ row[0][:50] }}...</td>
                        <td>{{ row[1] }}</td>
                        <td>{{ row[2] }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>

        </div>
    </div>
    <script>
        const spamCount = {{ spam_count | tojson }};
        const hamCount = {{ ham_count | tojson }};

        new Chart(document.getElementById('spamChart'), {
            type: 'pie',
            data: {
                labels: ['Spam', 'Not Spam'],
                datasets: [{
                    data: [spamCount, hamCount]
                }]
            },
            options: {
                responsive: false
            }
        });
    </script>

    <footer class="bg-dark text-light mt-5 pt-4 pb-3">
        <div class="container">
            <div class="row">

                <div class="col-md-4">
                    <h5>Spam Detection System</h5>
                    <p>
                        An AI-based email spam detection system that classifies
                        emails into Inbox or Spam using Machine Learning and NLP.
                    </p>
                </div>

                <div class="col-md-4">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="/" class="text-light text-decoration-none">Home</a></li>
                        <li><a href="/compose" class="text-light text-decoration-none">Compose</a></li>
                        <li><a href="/inbox" class="text-light text-decoration-none">Inbox</a></li>
                        <li><a href="/spam" class="text-light text-decoration-none">Spam</a></li>
                        <li><a href="/dashboard" class="text-light text-decoration-none">Dashboard</a></li>
                    </ul>
                </div>

                <div class="col-md-4">
                    <h5>Project Info</h5>
                    <p>
                        Developed using Flask, Machine Learning (Naive Bayes),
                        and MySQL database.
                    </p>
                    <p>Internship Project – 2026</p>
                </div>

            </div>

            <hr class="border-light">

            <div class="text-center">
                © 2026 Spam Detection System | Developed by Tejas Suryavanshi
            </div>
        </div>
    </footer>

</body>

</html>